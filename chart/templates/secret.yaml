{{- if .Values.secrets.create }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "letta.secretName" . }}
  labels:
    {{- include "letta.labels" . | nindent 4 }}
    app.kubernetes.io/component: secrets
type: Opaque
data:
{{- if .Values.database.enabled }}
  {{- $dbPassword := .Values.secrets.databasePassword | default .Values.database.postgres.password }}
  {{- if $dbPassword }}
  database-password: {{ $dbPassword | b64enc | quote }}
  {{- end }}
{{- end }}
{{- if .Values.externalDatabase.enabled }}
  {{- if .Values.secrets.externalDatabaseHost }}
  external-database-host: {{ .Values.secrets.externalDatabaseHost | b64enc | quote }}
  {{- else if .Values.externalDatabase.host }}
  external-database-host: {{ .Values.externalDatabase.host | b64enc | quote }}
  {{- end }}
  {{- $extDbUser := .Values.secrets.externalDatabaseUser | default .Values.externalDatabase.user }}
  {{- if $extDbUser }}
  external-database-user: {{ $extDbUser | b64enc | quote }}
  {{- end }}
  {{- $extDbPassword := .Values.secrets.externalDatabasePassword | default .Values.externalDatabase.password }}
  {{- if $extDbPassword }}
  external-database-password: {{ $extDbPassword | b64enc | quote }}
  {{- end }}
  {{- $extDbName := .Values.secrets.externalDatabaseName | default .Values.externalDatabase.database }}
  {{- if $extDbName }}
  external-database-name: {{ $extDbName | b64enc | quote }}
  {{- end }}
  {{- $extDbUri := .Values.secrets.externalDatabaseUri | default .Values.externalDatabase.uri }}
  {{- if $extDbUri }}
  external-database-uri: {{ $extDbUri | b64enc | quote }}
  {{- end }}
{{- end }}
{{- if .Values.secrets.openaiApiKey }}
  openai-api-key: {{ .Values.secrets.openaiApiKey | b64enc | quote }}
{{- end }}
{{- if .Values.secrets.groqApiKey }}
  groq-api-key: {{ .Values.secrets.groqApiKey | b64enc | quote }}
{{- end }}
{{- if .Values.secrets.anthropicApiKey }}
  anthropic-api-key: {{ .Values.secrets.anthropicApiKey | b64enc | quote }}
{{- end }}
{{- if .Values.secrets.azureApiKey }}
  azure-api-key: {{ .Values.secrets.azureApiKey | b64enc | quote }}
{{- end }}
{{- if .Values.secrets.geminiApiKey }}
  gemini-api-key: {{ .Values.secrets.geminiApiKey | b64enc | quote }}
{{- end }}
{{- if .Values.secrets.openllmApiKey }}
  openllm-api-key: {{ .Values.secrets.openllmApiKey | b64enc | quote }}
{{- end }}
{{- if .Values.secrets.clickhouseUsername }}
  clickhouse-username: {{ .Values.secrets.clickhouseUsername | b64enc | quote }}
{{- end }}
{{- if .Values.secrets.clickhousePassword }}
  clickhouse-password: {{ .Values.secrets.clickhousePassword | b64enc | quote }}
{{- end }}
{{- end }}

